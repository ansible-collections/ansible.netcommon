---
- name: "Fetch command output"
  cisco.nxos.nxos_command:
    commands:
      - show version
  register: version_output

- name: Set path for textfsm templates
  ansible.builtin.set_fact:
    textfsm_template_path: "{{ role_path }}/templates/nxos_show_version.textfsm"

- name: "Invoke parse_cli_textfsm"
  ansible.builtin.set_fact:
    device_neighbors: "{{ version_output.stdout[0] | parse_cli_textfsm(textfsm_template_path) }}"
